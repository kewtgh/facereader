/* ======================================================================
 * FaceReader – Production _custom.scss (Rebuild v2)
 * 目标：
 * - 作者卡片/专题栏/TOC/推荐卡：真正卡片化 + 有 padding + 更美观
 * - 推荐卡字体变小
 * - blockquote 不要斜体（同时更现代的字体与引号装饰）
 * - 首页三栏下面细横线去掉
 * - 最近更新、About 都变成“好看的模块”，About 必须是卡片
 * - 去重：同一个块只写一套规则，避免互相覆盖
 * ==================================================================== */


/* ======================================================================
 * 0) Design Tokens（统一风格，后面都引用）
 * ==================================================================== */

$fr-max-page: 1240px;

$fr-card-radius: 1rem;
$fr-card-bg: mix($background-color, #ffffff, 94%);
$fr-card-bg-soft: mix($background-color, #ffffff, 97%);
$fr-card-border: 1px solid mix(#000000, $border-color, 6%);
$fr-card-border-soft: 1px solid mix(#000000, $border-color, 4%);

$fr-shadow: 0 4px 14px rgba(15, 23, 42, 0.05);
$fr-shadow-hover: 0 12px 28px rgba(15, 23, 42, 0.10);

$fr-pad-md: 1rem;
$fr-pad-lg: 1.25rem;

$fr-text-sm: 0.92rem;
$fr-text-md: 0.98rem;

$fr-title: 1.15rem;

$fr-link: $link-color;


/* ======================================================================
 * 1) Typography：正文更舒服
 * ==================================================================== */

.page__title {
  line-height: 1.25;
}

.page__content {
  line-height: 1.85;
}

/* ======================================================================
 * 2) 引用 blockquote：不要斜体 + 更干净的风格
 * ==================================================================== */

.page__content blockquote {
  margin: 1.5rem 0;
  padding: 0.95rem 1.05rem 0.95rem 1.15rem;
  border-inline-start: 5px solid $primary-color !important;
  background: mix($primary-color, #ffffff, 92%) !important;
  border-radius: 0.75rem;
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);

  /* ✅ 关键：不要斜体 */
  font-style: normal !important;

  /* 更现代的字体选择：优先系统无衬线，与你站点整体更一致 */
  font-family: $sans-serif;
  font-size: 0.98rem;
  color: darken($text-color, 4%);
  position: relative;
}

.page__content blockquote p {
  margin: 0.35rem 0;
  font-style: normal !important;
  font-size: 1.02rem;
}

.page__content blockquote::before {
  content: "“";
  position: absolute;
  inset-inline-start: 0.5rem;
  inset-block-start: 0.1rem;
  font-size: 3rem;
  line-height: 1;
  color: rgba($primary-color, 0.25);
  pointer-events: none;
}


/* ======================================================================
 * 3) Hero → 正文间距（收紧但不挤）
 * ==================================================================== */

.page__hero--overlay .wrapper {
  min-height: 360px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.page__hero--overlay + .page,
.page__hero + .page {
  margin-top: 0.9rem;
}

/* 文章页：再紧凑一点 */
.layout--single .page__hero--overlay + .page,
.layout--single .page__hero + .page {
  margin-top: 0.7rem;
}


/* ======================================================================
 * 4) 文章页整体宽度 & “正文大空白”终结
 * ==================================================================== */

@include breakpoint($x-large) {
  .layout--single .page {
    max-width: $fr-max-page;
  }
}

.layout--single .page {
  column-gap: 3rem;
  grid-column-gap: 3rem;
}

/* ✅ 关键修复：正文不要被往下推 */
.layout--single .page__content {
  margin-top: 0 !important;
}


/* ======================================================================
 * 5) 通用卡片体系（作者卡 / 专题栏 / TOC / 推荐卡 / 首页卡片 都用它）
 * ==================================================================== */

@mixin fr-card($bg: $fr-card-bg, $border: $fr-card-border) {
  background: $bg;
  border: $border;
  border-radius: $fr-card-radius;
  box-shadow: $fr-shadow;
}

@mixin fr-card-hover {
  transition: transform 0.15s ease, box-shadow 0.15s ease;
  &:hover {
    transform: translateY(-2px);
    box-shadow: $fr-shadow-hover;
  }
}


/* ======================================================================
 * 6) Sidebar：作者卡片
 * ==================================================================== */

.layout--single .sidebar .h-card {
  @include fr-card($fr-card-bg-soft, $fr-card-border-soft);
  padding: 1.25rem 1.1rem 1.15rem; /* ✅ 有空间 */
  text-align: center;
}

.layout--single .sidebar .author__avatar {
  width: 84px;
  height: 84px;
  margin: 0 auto 0.75rem;
}

.layout--single .sidebar .author__avatar img {
  border-radius: 50%;
}

.layout--single .sidebar .author__name {
  font-size: 1.02rem;
  margin: 0 0 0.35rem;
}

.layout--single .sidebar .author__bio {
  font-size: 0.9rem;
  line-height: 1.65;
  color: $muted-text-color;
  margin-top: 0.35rem;
}

/* 链接列表：增加间距与可读性 */
.layout--single .sidebar .author__urls-wrapper {
  margin-top: 0.9rem;
}

.layout--single .sidebar .author__urls-wrapper > .btn {
  display: none; /* 保持你原来的清爽做法 */
}

.layout--single .sidebar .author__urls {
  font-size: 0.92rem;
  line-height: 1.7;
}

.layout--single .sidebar .author__urls li {
  margin: 0.25rem 0; /* ✅ 每行有呼吸 */
}

.layout--single .sidebar .author__urls a {
  text-decoration: none;
}


/* ======================================================================
 * 7) Sidebar：专题栏（nav__list）
 * ==================================================================== */

.layout--single .sidebar .nav__list {
  @include fr-card($fr-card-bg-soft, $fr-card-border-soft);
  padding: 1.1rem 1.1rem 1rem;
  margin-top: 1rem;
}

.layout--single .sidebar .nav__title {
  margin: 0 0 0.65rem;
  padding: 0;
  font-family: $sans-serif;
  font-size: 1.25rem;
  font-weight: 650;
  letter-spacing: 0.2px;
}

.layout--single .sidebar .nav__sub-title {
  display: block;
  margin: 0.85rem 0 0.5rem;
  padding: 0.35rem 0 0;
  font-family: $sans-serif;
  font-size: 1.12rem;
  font-weight: 650;
  text-transform: none;
  border-bottom: 1px solid mix(#000, $border-color, 8%);
}

.layout--single .sidebar .nav__items {
  margin: 0.5rem 0 0.6rem;
  font-size: 1.05rem;
  line-height: 2;
}

.layout--single .sidebar .nav__items a {
  color: $text-color;
  text-decoration: none;
  border-radius: 0.4rem;
  padding: 0.12rem 0.15rem;

  &:hover {
    color: $fr-link;
    background: mix($background-color, #ffffff, 85%);
  }
}


/* ======================================================================
 * 8) 右侧 TOC：真正卡片化 + 更精致
 * ==================================================================== */

.layout--single .sidebar .toc {
  @include fr-card($fr-card-bg-soft, $fr-card-border-soft);
  padding: 0; /* 内部自己控制 */
  overflow: hidden; /* 顶部条更干净 */
  margin-top: 1rem;
}

/* TOC 顶部标题条（深色条） */
.layout--single .sidebar .toc .nav__title,
.layout--single .sidebar .toc .toc__title {
  margin: 0;
  padding: 0.75rem 0.9rem;
  background: #1f344b;
  color: #fff;
  font-size: 0.98rem;
  font-weight: 650;
}

/* 目录正文 */
.layout--single .sidebar .toc__menu {
  font-size: 0.92rem;        /* ✅ 小一些更像辅助信息 */
  line-height: 1.6;
  padding: 0.75rem 0.85rem 0.85rem;
}

.layout--single .sidebar .toc__menu a {
  display: block;
  color: $text-color;
  text-decoration: none;
  padding: 0.22rem 0.35rem;
  border-radius: 0.45rem;
  word-break: break-word;

  &:hover {
    background: mix($background-color, #ffffff, 86%);
    color: $fr-link;
  }
}

.layout--single .sidebar .toc__menu li ul > li a {
  padding-inline-start: 1.15rem;
  opacity: 0.95;
}


/* ======================================================================
 * 9) 推荐栏：卡片必须有 padding + 字号必须降
 * ==================================================================== */

.page__related-title {
  font-size: 1.15rem;
  margin-bottom: 0.75rem;
}

/* 推荐区 grid 间距更舒服 */
.page__related .grid__wrapper {
  gap: 1.25rem;
}

.page__related .grid__wrapper .archive__item {
  @include fr-card($fr-card-bg, $fr-card-border);
  @include fr-card-hover;

  /* ✅ 关键：有 padding，不贴边 */
  padding: 0.95rem 1rem 0.9rem;

  /* ✅ 关键：推荐卡整体字更小 */
  font-size: $fr-text-sm;
}

/* 标题/摘要再次压小一点，保证不抢正文 */
.page__related .grid__wrapper .archive__item-title {
  font-size: 0.93rem;
  margin-bottom: 0.35rem;
  line-height: 1.35;
}

.page__related .grid__wrapper .archive__item-excerpt {
  font-size: 0.83rem;
  line-height: 1.35;
}

/* 限制推荐卡摘要高度，防止无限拉长 */
.page__related .archive__item-excerpt {
  max-height: 5.8em;              /* ≈ 5 行 */
  overflow: hidden;
}

/* ======================================================================
 * 10) 首页三栏 feature_row：卡片化 + 去掉下面细横线
 * ==================================================================== */

.home .feature__item .archive__item {
  @include fr-card($fr-card-bg, $fr-card-border);
  @include fr-card-hover;
  background: mix($background-color, #ffffff, 94%) !important;
  border-radius: 1rem !important;
  border: 1px solid mix(#000, $border-color, 6%) !important;
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06) !important;
  padding: 1.1rem 1.1rem 1rem;
  font-size: $fr-text-md;
}

/* feature_row 下方那根细横线：去掉 */
.home .page__content > hr {
  display: none !important;
}

/* 三栏按钮更像“站点动作按钮”，不那么松散 */
.feature__item .btn {
  margin-top: 0.85rem;
}

/* 防止被其他规则“拍扁” */
.home .feature__item {
  margin-bottom: 1.5rem;
}

/* ======================================================================
 * 11) 首页“最近更新”：卡片化 + 标题区更像模块
 * ==================================================================== */

/* 最近更新：明确一个模块边界 */
.home-section--posts {
  padding-bottom: 2.5rem;
  border-bottom: 1px solid mix(#000, $border-color, 6%);
  margin-bottom: 2.5rem;
}

.home-section--posts .home-section__header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 0.9rem;
}

.home-section--posts .home-section__title {
  font-size: 1.25rem;
  font-weight: 650;
  margin: 0;
}

.home-section--posts .home-section__more {
  font-size: 0.95rem;
  text-decoration: none;

  &:hover {
    text-decoration: underline;
  }
}

/* 最近更新卡片（entries-grid） */
.home .entries-grid .archive__item,
.home .entries-grid .archive__item--grid {
  @include fr-card($fr-card-bg, $fr-card-border);
  @include fr-card-hover;
  padding: 0.95rem 1rem 0.9rem; /* ✅ 有 padding */
}

.home .entries-grid .archive__item-title {
  font-size: 1rem;
  line-height: 1.35;
  margin-bottom: 0.35rem;
}

.home .entries-grid .archive__item-excerpt {
  font-size: 0.9rem;
  line-height: 1.65;
}

/* 最近更新卡片必须是独立卡片 */
.home .entries-grid .archive__item {
  background: mix($background-color, #ffffff, 94%) !important;
  border-radius: 1rem !important;
  border: 1px solid mix(#000, $border-color, 6%) !important;
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06) !important;
  padding: 1rem 1rem 0.95rem !important;
}

/* ======================================================================
 * 12) 首页 About
 * ==================================================================== */

/* 1️⃣ About 外层 section：明确这是一个独立模块 */
.home-section--about-cta {
  margin-top: 3.5rem;
}

/* 2️⃣ About 主卡片：恢复你原来的“柔和卡片” */
.home-section--about-cta .home-cta {
  background: mix(#ffffff, $background-color, 80%) !important;
  border: 1px solid mix(#000000, $border-color, 6%) !important;
  border-radius: 1.25rem !important;
  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06) !important;

  padding: 1.6rem 1.5rem !important;
}

/* 3️⃣ 内部布局：左图右文（与你最早的 CSS 一致） */
.home-cta--about .home-cta__inner {
  display: flex !important;
  align-items: center;
  gap: 1.75rem;
}

/* 左侧图片 */
.home-cta--about .home-cta__media {
  flex: 0 0 38%;
}

.home-cta--about .home-cta__media img {
  width: 100%;
  max-height: 260px;
  object-fit: cover;
  border-radius: 1rem;
  display: block;
}

/* 4️⃣ 右侧文本区：恢复你原来的字号与行距 */
.home-cta--about .home-cta__text {
  flex: 1 1 0;
}

.home-cta--about .home-cta__text h2 {
  font-size: 1.4rem;
  line-height: 1.4;
  margin-bottom: 0.6rem;
  font-weight: 600;
}

.home-cta--about .home-cta__text p {
  font-size: 0.95rem;
  line-height: 1.7;
  margin-bottom: 0.85rem;
}

.home-cta--about .home-cta__text ul {
  margin: 0.75rem 0 1rem;
  padding-left: 1.2rem;
}

.home-cta--about .home-cta__text li {
  margin-bottom: 0.4rem;
}

/* 说明性文字（你原 CSS 里有这个层级） */
.home-cta--about .home-cta__note {
  font-size: 0.92rem;
  line-height: 1.65;
  color: $muted-text-color;
  margin-top: 0.75rem;
}

/* CTA 按钮：与你原设计一致，不夸张 */
.home-cta--about .btn--primary {
  margin-top: 0.85rem;
  min-width: 170px;
}


/* 5️⃣ 移动端：回到你原来的上下排逻辑 */
@include breakpoint(max-width $small) {
  .home-cta--about .home-cta__inner {
    flex-direction: column;
    align-items: stretch;
  }

  .home-cta--about .home-cta__media {
    flex: none;
  }

  .home-cta--about .home-cta__media img {
    max-height: 220px;
  }

  .home-cta--about .home-cta__text h2 {
    font-size: 1.15rem;
  }
}


/* ======================================================================
 * 13) 图片 & 图注：
 * ==================================================================== */

.page__content figure {
  margin-bottom: 0.8rem;
}

.page__content figure > img {
  display: block;
  margin-bottom: 0.12rem;
}

.page__content figure > figcaption {
  margin-top: 0;
  margin-bottom: 0.55rem;
}

.page__content .image-caption,
.page__content em.image-caption,
.page__content p.image-caption {
  display: block;
  margin-top: 0.12rem;
  margin-bottom: 0.55rem;
  text-align: center;
  font-size: 0.9rem;
  font-style: normal; /* ✅ 防止斜体 */
}

/* ======================================================================
 * 14) About 页面侧边栏（不是首页 About 卡片）
 * ==================================================================== */

/* About 页 sidebar 整体卡片化 */
.layout--page .sidebar .nav__list {
  background: mix($background-color, #ffffff, 96%);
  border-radius: 1rem;
  padding: 1.1rem 1.1rem 1rem;
  box-shadow: 0 4px 14px rgba(15, 23, 42, 0.05);
}

/* About 页 sidebar 字号 */
.layout--page .sidebar .nav__items {
  font-size: 1.02rem;
  line-height: 1.9;
}

/* ======================================================================
 * 15) 按钮美化
 * ==================================================================== */

.btn {
  font-family: $sans-serif;
  font-weight: 500;
  font-size: 0.95rem;

  border-radius: 999px;          /* 你原来就是偏胶囊形 */
  padding: 0.55rem 1.5rem;       /* 不要太高，避免 SaaS 感 */

  line-height: 1.4;
  letter-spacing: 0.1px;

  transition:
    background-color 0.15s ease,
    color 0.15s ease,
    box-shadow 0.15s ease,
    transform 0.12s ease;

  text-decoration: none;
}


/* ======================================================================
 * 2️⃣ 主按钮 btn--primary（你站点最重要的按钮）
 * ==================================================================== */

.btn--primary {
  background-color: #ffffff;                 /* 你原来的“白底主按钮” */
  color: $primary-color !important;

  border: 1px solid mix($primary-color, #000000, 10%);

  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12);
}

/* hover / focus：非常克制，只给“被注意到”的反馈 */
.btn--primary:hover,
.btn--primary:focus {
  background-color: mix(#ffffff, $primary-color, 96%);
  color: darken($primary-color, 8%) !important;

  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.18);
  transform: translateY(-1px);
}

/* active：压回去一点点 */
.btn--primary:active {
  transform: translateY(0);
  box-shadow: 0 3px 10px rgba(15, 23, 42, 0.14);
}


/* ======================================================================
 * 3️⃣ 次按钮 btn--secondary（Hero、About 等用）
 * ==================================================================== */

.btn--secondary {
  background-color: rgba(255, 255, 255, 0.14);
  color: #ffffff !important;

  border: 1px solid rgba(255, 255, 255, 0.85);

  box-shadow: 0 3px 10px rgba(15, 23, 42, 0.14);
}

.btn--secondary:hover,
.btn--secondary:focus {
  background-color: rgba(255, 255, 255, 0.22);
  border-color: #ffffff;
  box-shadow: 0 5px 16px rgba(15, 23, 42, 0.18);
}


/* ======================================================================
 * 4️⃣ 内容区里的“行动按钮”（首页三栏 / About 卡片）
 * ==================================================================== */

/* 让按钮更像“阅读动作”，而不是 CTA */
.home .btn--primary,
.home-section--about-cta .btn--primary {
  font-size: 0.94rem;
  padding: 0.5rem 1.4rem;
  min-width: 160px;
}

/* 三栏 feature 的按钮：稍微稳一点 */
.feature__item .btn--primary {
  margin-top: 0.85rem;
}


/* ======================================================================
 * 5️⃣ 推荐 / 最近更新里的按钮（如果有）
 * ==================================================================== */

.page__related .btn,
.home .entries-grid .btn {
  font-size: 0.88rem;
  padding: 0.45rem 1.2rem;
}


/* ======================================================================
 * 6️⃣ 禁用态 / 不可点击态（防止难看）
 * ==================================================================== */

.btn:disabled,
.btn.is-disabled {
  opacity: 0.55;
  box-shadow: none;
  cursor: not-allowed;
}


/* ======================================================================
 * 7️⃣ 移动端：按钮不要太宽、太高
 * ==================================================================== */

@include breakpoint(max-width $small) {
  .btn {
    font-size: 0.92rem;
    padding: 0.5rem 1.3rem;
  }
}

/* ======================================================================
 * 16) 小修：让卡片里的文字不会贴边（兜底）
 * ==================================================================== */

/* 某些 archive__item 主题可能内部没有 padding，这里兜底 */
.archive__item {
  overflow: hidden;
}

.archive__item-body {
  padding-top: 0.2rem;
}
